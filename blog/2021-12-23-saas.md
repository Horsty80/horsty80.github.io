---
title: "Les Saas aux services des projets persos"
description: "Je vous explique quels SaaS - Software as a Service - j'utilise pour m'aider dans le developpement de mes projets persos"
date: 2021-12-23
tags: ["Tips", "Avent", "Firebase", "Netlify", "Heroku", "MongoDb", "Gitlab"]
keywords: ["Tips", "Avent", "Firebase", "Netlify", "Heroku", "MongoDb", "Gitlab"]
image: "/img/23.jpg"
slug: /saas
authors: [chue]
---

Je passe beaucoup de temps √† faire des prototypes de projets, j'ai le fameux syndr√¥me du `projet perso`, je ne compte m√™me plus le nombre de repos que j'ai sur Github ou Gitlab. Tr√®s peu d'entre eux sont termin√©s, mais c'est le but en fait d'un projet perso.

Quelques projets ont la chance d'√™tre d√©ploy√©s et une infime partie ont m√™me la chance d'avoir des utilisateurs !

En revanche aucun projet n'est mon√©tis√©, pourtant j'utilise des serveurs, de l'h√©bergement, des bases de donn√©es, etc : comment je fais ?

<!--truncate-->

√Ä part 3-4 noms de domaines (environ 50‚Ç¨), je ne d√©pense pas d'argent. J'en d√©penserai pour un projet quand celui-ci sera vou√© √† devenir mon activit√© principale. En attendant, j'utilise des solutions `Saas` gratuites et j'y trouve mon compte.

Je vais vous lister celles que j'utilise sur mes projets.

## Firebase

Firebase fait tout ! On pourrait se contenter seulement de firebase.

[Firebase](https://firebase.google.com) c'est l'ensemble de services propos√©s par Google.
Les services sont gratuits avec des quotas d'utilisation dans la formule de base, autrement, √ßa fonctionne comme n'importe quel cloud provider, vous payerez ce que vous consommez.

Vous y retrouverez :

- des bases de donn√©es (Firestore),
- de l'authentification,
- des notifications,
- de l'h√©bergement,
- et bien d'autres services.

Firebase propose une documentation compl√®te qui vous aide pour int√©grer les diff√©rents services sur votre application. La communaut√© est active, parfait si vous √™tes bloqu√©.

Firebase propose un SDK pour les projets en Javascript, avec la version 9, [npm firebase](https://www.npmjs.com/package/firebase) , qui a √©t√© release cette ann√©e, les √©quipes de Google apportent des API modulaires pour manipuler Firebase. Vous avez notamment le `tree-shaking` qui vous permet de conserver une application la plus petite et rapide possible.

Concr√®tement √† quoi ressemble l'utilisation de firebase ?

Voici un petit exemple sur un de mes projets qui me permet d'uploader des photos et de stocker le lien permettant de les r√©cup√©rer.

```js
const id = "123";
const cameraImage =
  "data:text/plain;base64,5b6p5Y+344GX44G+44GX44Gf77yB44GK44KB44Gn44Go44GG77yB";

// Cr√©er une r√©ference vers mon fichier 'posts/123'
const storageRef = ref(storage, `posts/${id}`);
// Upload du fichier vers ma r√©f√©rence 'posts/123'
uploadString(storageRef, cameraImage, "data_url")
  // UploadString est une Promesse, peut aussi retourner une UploadTask.
  .then((snapshot) => {
    // Upload r√©ussi, on peut r√©cup√©rer l'URL de t√©l√©chargement
    getDownloadURL(snapshot.ref).then((downloadURL) => {
      // Sauvegarde de l'URL dans une collection de 'posts'
      addDoc(collection(db, "posts"), {
        imageUrl: downloadURL,
        username: "Cyril",
        read: false,
        timestamp: serverTimestamp(),
      });
    });
  })
  .catch((error) => {
    // error function
    console.log(error);
  });
```

Expliquons cet exemple, nous avons une image encod√©e en base64 qui est une chaine de string.
Nous allons uploader dans le service de storage de firebase notre image.

```bash
uploadString(storageRef, cameraImage, "data_url", null);
//              ^             ^          ^          ^
//              |             |          |          |
//             (a)           (b)        (c)        (d)
// a : la r√©f√©rence de mon document, l√† o√π sera stock√© le document
// b : la string √† upload
// c : (optionel) - le format de la string upload√©
// d : (optionel) - Metadata √† ajouter
```

`uploadString` est une promesse, nous pouvons donc ajouter un `then()`, nous avons acc√®s √† un `UploadResult`, ici l'objet `snapshot`, ce qui nous permet d'avoir la `ref` de notre image upload√©e.

![interface firebase avec un tableau, une entr√© dans ce tableau correspond √† l'image upload√©, il y √† un panel sur le cot√© droit qui permet d'obtenir les infos d√©taill√© et le visuel de la photo](/img/image-uploade.png)

Firebase nous met √† disposition la m√©thode `getDownloadURL(ref)` qui est une promesse et nous renvoit la `downloadUrl` du fichier, c'est l'url public qui permet d'acc√©der √† l'image.

Nous allons sauvegarder cette url pour pouvoir l'obtenir √† l'avenir plus facilement au travers de notre application.
On a plus qu'√† ajouter cette url dans un document que l'on stocke dans firestore.

Et voil√† !

![model de donn√©e ou l'on voit le champ imageUrl qui contient l'url firebastorage du document](/img/doc-download-url.png)

Il reste encore plein de choses √† d√©couvrir avec l'utilisation de firebase : j'aime par exemple utiliser ce service pour la partie authentification des utilisateurs. Firebase propose un large choix de moyens d'authentification qui sont tr√®s simples √† impl√©menter sur vos projets.

![liste des fournisseurs de connexion disponible comme google qui est selectionn√© ou facebook, twitter etc.](/img/signin-method.png)

> Firebase propose une CLI, parfait pour mettre en place un pipeline de d√©ploiement continu.

## Netlify

Vous pouvez h√©berger vos projets via Firebase ou m√™me avec `Gitlab Pages`, mais personnellement j'aime utiliser [Netlify](https://www.netlify.com), d'ailleurs mon blog est h√©berg√© gr√¢ce √† leurs services. Ils proposent une int√©gration avec Gitlab, Github et Bitbucket, la configuration par d√©faut d√©clenchera un d√©ploiement √† chaque commit sur votre branche `main`. C'est un bon d√©but pour s'initier au d√©ploiement continu.

Du c√¥t√© de Gitlab √ßa se caract√©rise par un pipeline `external`.

![les bulles de pipelines de gitlab lors d'un run ci/cd avec la tooltip "external: passed" pour l'une des bulles](/img/pipeline-externe.png)

Dans les autres services propos√©s par Netlify il y a les `Forms`, je vous laisse cet [article de Brian Li](https://brianli.com/how-to-create-a-contact-form-in-hugo-with-netlify-forms/) qui vous explique comment utiliser le service avec un blog en Hugo üëå.

## MongoDb & Heroku

Si vous voulez mettre une Api √† disposition par exemple un `CRUD`, j'aime utiliser le combo [MongoDb](https://www.mongodb.com/fr-fr/cloud) et [Heroku](https://www.heroku.com).
MongoDb vous permet d'h√©berger une base de donn√©es, avec une limitation de taille, mais pour des petits projets c'est suffisant.
Apr√®s avoir configur√© et import√© vos donn√©es, vous n'aurez plus qu'√† utiliser la `connection string` dans votre code.

```js
// Exemple d'utilisation dans mon Api GraphQl
const mongoConnectString =
  process.env.NODE_ENV === "production"
    ? process.env.MONGO_DB_CONNEXION_STRING
    : "mongodb://localhost:27017/magic-tools";
```

Heroku permet de d√©ployer des serveurs gratuitement, j'ai par exemple une API en GraphQl d√©ploy√©e chez Heroku. Vous aurez acc√®s √† une CLI qui permet d'int√©grer H√©roku dans vos pipelines Gitlab. Les serveurs d'Heroku fonctionnent `on-demand` en version gratuite, ils ne seront up que lorsqu'ils sont sollicit√©s : cela peut entrainer des petits d√©lais au d√©marrage mais rien de d√©rangeant.

```yml
image: node:latest

before_script:
  - apt-get update -qy
  - apt-get install -y ruby-dev
  - gem install dpl

stages:
  - production

production:
  type: deploy
  stage: production
  image: ruby:latest
  script:
    - dpl --provider=heroku --app=$HEROKU_APP_PRODUCTION --api-key=$HEROKU_API_KEY --skip-cleanup
  only:
    - master
```
